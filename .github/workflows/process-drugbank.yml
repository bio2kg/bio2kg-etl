name: Process DrugBank
on:
  workflow_dispatch:
  push:
    branches: [ master ]
    paths:
    - 'datasets/drugbank'
    - '.github/workflows/process-drugbank.yml'
  # schedule:
  #   - cron:  '00 01 * * *'
    # Everyday at 01:00am GMT+1

jobs:

  process:
    runs-on: ["self-hosted", "dsri", "bio2kg" ]
    # strategy:
    #   matrix:
    #     python-version: [3.8]

    steps:
    - uses: actions/checkout@v2
      with:
        fetch-depth: 0
    # - name: Set up Python ${{ matrix.python-version }}
    #   uses: actions/setup-python@v2
    #   with:
    #     python-version: ${{ matrix.python-version }}

    - name: Hello 
      run: |
        echo "Hello bio2kg"

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    - name: Run ETL script
      run: |
        python datasets/check.py
      # python datasets/drugbank/load_drugbank.py

    - name: Update 
      run: |
        sudo yum update
